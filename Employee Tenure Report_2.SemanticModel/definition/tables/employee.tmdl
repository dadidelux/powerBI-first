table employee
	lineageTag: 01a918e2-0701-4432-821a-4b4a8f727eca

	column id
		dataType: int64
		formatString: 0
		lineageTag: ee3e84c8-6a72-4713-aebf-6d7b79b6f92d
		summarizeBy: sum
		sourceColumn: id

		annotation SummarizationSetBy = Automatic

	column external_id
		dataType: string
		lineageTag: f0bf7035-bc9a-4fe9-b658-ba22cf959878
		summarizeBy: none
		sourceColumn: external_id

		annotation SummarizationSetBy = Automatic

	column firstname
		dataType: string
		lineageTag: f3ea22ff-b2bf-4575-8c55-10a4580df2f4
		summarizeBy: none
		sourceColumn: firstname

		annotation SummarizationSetBy = Automatic

	column lastname
		dataType: string
		lineageTag: df6eb6eb-22b3-4d99-bcb9-5dc25e60d497
		summarizeBy: none
		sourceColumn: lastname

		annotation SummarizationSetBy = Automatic

	column email
		dataType: string
		lineageTag: 9abf545e-1abe-4f4b-b3e1-bb86ef4f2eb7
		summarizeBy: none
		sourceColumn: email

		annotation SummarizationSetBy = Automatic

	column homephone
		dataType: string
		lineageTag: 7764cbb4-86e7-48b9-aed3-01f8c1e15349
		summarizeBy: none
		sourceColumn: homephone

		annotation SummarizationSetBy = Automatic

	column mobilephone
		dataType: string
		lineageTag: 4debc218-de99-4ee2-977a-cfac6b1bc67e
		summarizeBy: none
		sourceColumn: mobilephone

		annotation SummarizationSetBy = Automatic

	column dateofbirth
		dataType: dateTime
		formatString: Long Date
		lineageTag: fa9e41c5-0120-4b59-8678-3b666cdccb74
		summarizeBy: none
		sourceColumn: dateofbirth

		variation Variation
			isDefault
			relationship: 73ad4444-c7ec-4dcc-be4b-1ff55cdcd604
			defaultHierarchy: LocalDateTable_57f21122-2fd6-46c2-a271-43eb898f70b6.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column datecreated
		dataType: dateTime
		formatString: Long Date
		lineageTag: 85c45b5a-9bfc-4d16-9230-ca70b8197c22
		summarizeBy: none
		sourceColumn: datecreated

		variation Variation
			isDefault
			relationship: 28cc872c-c74e-4d7d-984a-14f1540a3391
			defaultHierarchy: LocalDateTable_6838d4c4-c339-44cc-b6c6-e120ae666590.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column startdate
		dataType: dateTime
		formatString: dd-mmm-yy
		lineageTag: a6bbbc5d-3a70-47d5-9859-4acec6803736
		summarizeBy: none
		sourceColumn: startdate

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

		annotation PBI_FormatHint = {"isDateTimeCustom":true}

	column enddate
		dataType: dateTime
		formatString: dd-mmm-yy
		lineageTag: 98ac005b-5dd2-4f11-8d0f-4e676c69d14d
		summarizeBy: none
		sourceColumn: enddate

		variation Variation
			isDefault
			relationship: b2d5271a-bad8-42a7-b6f4-2146576e8d65
			defaultHierarchy: LocalDateTable_3983e722-a42b-4940-8913-005b00335a3a.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

		annotation PBI_FormatHint = {"isDateTimeCustom":true}

	column status
		dataType: string
		lineageTag: 1001a34a-e132-49a2-a467-7a2257f70853
		summarizeBy: none
		sourceColumn: status

		annotation SummarizationSetBy = Automatic

	column title
		dataType: string
		lineageTag: 82856535-706d-4550-a2c2-f558102ef162
		summarizeBy: none
		sourceColumn: title

		annotation SummarizationSetBy = Automatic

	column rate
		dataType: double
		lineageTag: 4c4e55a5-70dd-4aa7-b4f4-07159043073b
		summarizeBy: sum
		sourceColumn: rate

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column rate_unit
		dataType: string
		lineageTag: 550367e8-42f6-445b-94f7-e5622ffbbfd4
		summarizeBy: none
		sourceColumn: rate_unit

		annotation SummarizationSetBy = Automatic

	column reporting_dimension_values
		dataType: int64
		formatString: 0
		lineageTag: 252c3888-75a4-45a6-ac17-8a1106efdbb1
		summarizeBy: sum
		sourceColumn: reporting_dimension_values

		annotation SummarizationSetBy = Automatic

	column anniversary_date
		dataType: dateTime
		formatString: Long Date
		lineageTag: 3494422f-003b-4867-8b5b-d22059e4fe1e
		summarizeBy: none
		sourceColumn: anniversary_date

		variation Variation
			isDefault
			relationship: 8f6f2c4d-5b77-4810-9fcc-6a1282504066
			defaultHierarchy: LocalDateTable_f49c6ed3-af9c-4abf-9c1d-c88ec9b6068b.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column australian_resident
		dataType: boolean
		formatString: """TRUE"";""TRUE"";""FALSE"""
		lineageTag: 40daf652-111f-4e73-8061-5cfd3599f554
		summarizeBy: none
		sourceColumn: australian_resident

		annotation SummarizationSetBy = Automatic

	column automatically_pay_employee
		dataType: string
		lineageTag: be9bec94-db48-4c8d-b9f5-a1b3c94d09b4
		summarizeBy: none
		sourceColumn: automatically_pay_employee

		annotation SummarizationSetBy = Automatic

	column employment_type
		dataType: string
		lineageTag: 51f677bb-e7f5-495a-a653-11ad9ae98d25
		summarizeBy: none
		sourceColumn: employment_type

		annotation SummarizationSetBy = Automatic

	column hours_per_day
		dataType: double
		lineageTag: 3ac9cdc6-5bbb-4f7c-a56e-ff5e271602a6
		summarizeBy: sum
		sourceColumn: hours_per_day

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column hours_per_week
		dataType: double
		formatString: 0
		lineageTag: a2d9b0ef-b11c-4484-abae-1037e576b87e
		summarizeBy: sum
		sourceColumn: hours_per_week

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isDecimal":true}

	column tax_category
		dataType: string
		lineageTag: 6658abcf-ece7-4cc6-a1e6-5fb9729ce583
		summarizeBy: none
		sourceColumn: tax_category

		annotation SummarizationSetBy = Automatic

	column termination_reason
		dataType: string
		lineageTag: bd836bb9-d851-4884-b2d6-26e29b44cde9
		summarizeBy: none
		sourceColumn: termination_reason

		annotation SummarizationSetBy = Automatic

	column Tenure =
			
			DATEDIFF(employee[startdate],TODAY(),MONTH)
		dataType: int64
		formatString: 0
		lineageTag: 9e3ce958-6bf1-4e33-ac4e-2d6b38dfa109
		summarizeBy: sum
		isDataTypeInferred

		annotation SummarizationSetBy = Automatic

	column Today =
			
			TODAY()
		dataType: dateTime
		formatString: General Date
		lineageTag: 83e5028f-8e7d-4153-b0a4-e0072ad02d89
		summarizeBy: none
		isDataTypeInferred

		variation Variation
			isDefault
			relationship: d10ae159-50cb-4d64-b8e1-110ae553a9f8
			defaultHierarchy: LocalDateTable_f9c50196-0b1d-4c70-ad32-7ae6f2775841.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

	column 'Previous Month' =
			
			EDATE(employee[Today],-3)
		dataType: dateTime
		formatString: General Date
		lineageTag: 8e0a2e82-f5fa-4d5b-b388-840048faaf25
		summarizeBy: none
		isDataTypeInferred

		variation Variation
			isDefault
			relationship: bcde53f9-487b-4800-8123-0830d2b3bec7
			defaultHierarchy: LocalDateTable_c01a5dfe-6087-4544-9505-78e99be7ae52.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

	column New =
			
			if(year(employee[startdate]) = year(employee[Previous Month]) && MONTH(employee[startdate]) = month(employee[Previous Month]),1,0)
		dataType: int64
		formatString: 0
		lineageTag: 244972fa-2e3a-4f86-8446-74821c8abb69
		summarizeBy: sum
		isDataTypeInferred

		annotation SummarizationSetBy = Automatic

	column Transfer =
			
			If(employee[termination_reason] = "Transfer" && MONTH(employee[enddate]) = MONTH(employee[Previous Month]) && year(employee[enddate]) = year(employee[Previous Month]),1,0)
		dataType: int64
		formatString: 0
		lineageTag: 830e6ec5-0760-4091-b0e8-28ef1189ad3b
		summarizeBy: sum
		isDataTypeInferred

		annotation SummarizationSetBy = Automatic

	column Terminate =
			
			If( MONTH(employee[enddate]) = MONTH(employee[Previous Month]) && year(employee[enddate]) = year(employee[Previous Month]) && employee[status] <> "Active" && employee[termination_reason] <> "Transfer",1,0)
		dataType: int64
		formatString: 0
		lineageTag: 040774a2-53de-43c0-9ad8-53a425007ae6
		summarizeBy: sum
		isDataTypeInferred

		annotation SummarizationSetBy = Automatic

	column club_id
		dataType: int64
		formatString: 0
		lineageTag: fc9ad0e1-4e55-433f-829a-46f90cabd1fc
		summarizeBy: none
		sourceColumn: club_id

		annotation SummarizationSetBy = Automatic

	column Key =
			
			employee[email]&"/"&employee[enddate].[Date]
		dataType: string
		lineageTag: ed376628-5511-431b-8c79-545b40d9ff79
		summarizeBy: none
		isDataTypeInferred

		annotation SummarizationSetBy = Automatic

	column NewClub = ```
			CALCULATE(MIN(transfer[newclub]), ALLEXCEPT(employee, employee[Key])) 
			```
		dataType: string
		lineageTag: 50ebeccd-2c53-4160-8936-aa19e26b0c3b
		summarizeBy: none
		isDataTypeInferred

		annotation SummarizationSetBy = Automatic

	partition employee = m
		mode: import
		source =
				let
				    Source = Sql.Databases("pfbravo.database.windows.net"),
				    bravodwh = Source{[Name="bravodwh"]}[Data],
				    dbo_employees = bravodwh{[Schema="dbo",Item="employees"]}[Data]
				in
				    dbo_employees

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

